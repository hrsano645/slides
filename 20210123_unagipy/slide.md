---
marp: true
header: "**M1 Macã§Pythonã¨æ©Ÿæ¢°å­¦ç¿’ã‚’ã‚„ã‚ã†** "
footer: "by [@hrs_sano645](https://twitter.com/hrs_sano645)"
paginate: true
---

# M1 Macã§Pythonã¨æ©Ÿæ¢°å­¦ç¿’ã‚’ã‚„ã‚ã†

### Unagi.py å‹‰å¼·ä¼š37æšç›®ï½ã€ç¥4å‘¨å¹´ã€‘æ©Ÿæ¢°å­¦ç¿’ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹LTä¼šï½

2020/11/20 Hiroshi Sano

---

## ãŠå‰èª°ã‚ˆ

- Hiroshi Sano [@hrs_sano645](https://twitter.com/hrs_sano645) ğŸ :é™å²¡ã®ğŸ—»è¦‹ãˆã‚‹ã¨ã“ã‚
- JobğŸ’¼
  - [ä½é‡è¨­è¨ˆäº‹å‹™æ‰€ğŸš—âš™ï¸ğŸ“](https://sano-design.info)::è‡ªå‹•è»Šç³»æ©Ÿæ¢°ã®3Dè¨­è¨ˆäº‹å‹™æ‰€
  - ç±³è¾²å®¶ğŸŒ¾
- CommunityğŸ§‘â€ğŸ’»
  - ğŸ—»ğŸ: shizuoka.py, unagi.py, Pythoné§¿æ²³
  - ğŸ—»ğŸ: PyCon mini Shizuokaã‚¹ã‚¿ãƒƒãƒ•
  - ğŸ: PyCon JP 2020 ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«è¬›å¸«

---

## M1 Macbook Airè²·ã„ã¾ã—ãŸğŸ‰

---

ãŠã‚¹ã‚¹ãƒ¡ï¼
ä»Šæ—¥ã¯~~è‡ªæ…¢~~å¸ƒæ•™ã—ã«æ¥ã¾ã—ãŸã€‚

---

## ã¾ã¨ã‚

- M1 Macã‚ã¡ã‚ƒãã¡ã‚ƒå¿«é©
- Pythonä½¿ã†ãªã‚‰Rossetaãƒ¢ãƒ¼ãƒ‰ãŒåŸºæœ¬çš„ã«ãŠã™ã™ã‚
- M1æœ€é©åŒ–ã®Tensorflowã‚’è©¦ã—ã¦ã¿ãŸ

---

## M1 Macã‚ã¡ã‚ƒãã¡ã‚ƒå¿«é©ã§ã™

---

## M1 Macã‚ã¡ã‚ƒãã¡ã‚ƒå¿«é©ã§ã™

è²·ã£ãŸã‚‚ã®

- M1 Macbook Air: 124,800å††
- CPU 8core / GPU 7 Core
- 256GB: ãã‚“ãªã«å…¥ã‚Œã‚‹ã‚‚ã®ãŒãªã‘ã‚Œã°ååˆ†
  - å¿…è¦ãªã‚‰å¤–ä»˜ã‘SSD: 1TB1ä¸‡å††ãã‚‰ã„ã§è²·ãˆã‚‹
- ãƒ¡ãƒ¢ãƒª 16GB

---

## M1 Macå¿«é©ãªã“ã¨ä¸€è¦§

- Macbook Airã¯ãƒ•ã‚¡ãƒ³ãƒ¬ã‚¹ã€‚ä»–ã®ã‚‚ã®ã‚‚é€šå¸¸ã¯ãƒ•ã‚¡ãƒ³å›ã‚‰ãªã„
- 4Kå‹•ç”»æµã—ã¦ã„ã¦ã‚‚å¹³ç„¶ã¨ã—ã¦ã‚‹
- ã‚ˆãä½¿ã†ã‚¢ãƒ—ãƒªã¯ã»ã¼å‹•ã: chrome, vscode, office, ãªã©ãªã©

---

## ãŠã™ã™ã‚ç†ç”±: å‡¦ç†æ—©ã„

- OSè‡ªä½“ã®æŒ™å‹•ã‚‚æ—©ã„
- Intelãƒã‚¤ãƒŠãƒªã®å¤‰æ›ï¼ˆRossetaï¼‰ã‚’ã—ã¦ã‚‚ã»ã¨ã‚“ã©é…ã„ã¨æ„Ÿã˜ãªã„
  - ã‚¢ãƒ—ãƒªã®åˆå›èµ·å‹•ã®ãƒã‚¤ãƒŠãƒªå¤‰æ›ã«ã‚‚ãŸã¤ãã‘ã©ãã‚Œä»¥é™ã¯è‡³ã£ã¦æ™®é€š
  - ã»ã¨ã‚“ã©å¤šãã®ã‚¢ãƒ—ãƒªã‚’Rossetaãƒ¢ãƒ¼ãƒ‰ã§ä½¿ã£ã¦ã‚‹ã‘ã©ä¸å…·åˆã‚‰ã—ã„ã‚‚ã®ã«å½“ãŸã£ã¦ãªã„
- 4Kå‹•ç”»å›ã—ãªãŒã‚‰æ™®é€šã«ä½œæ¥­ã—ã¦ã„ã¦ã‚‚æ°—ã«ãªã‚‰ãªã„
- ã—ã‹ã‚‚ä¸å®‰å®šã•ã‚‚æ„Ÿã˜ãªã„
  - Appleåˆç‰©æ„ŸãŒå…¨ããªã„

---

## ãŠã™ã™ã‚ç†ç”±: ãƒãƒƒãƒ†ãƒªãƒ¼æŒã¡

ãƒ–ãƒ©ã‚¦ã‚¶ãŸãã•ã‚“é–‹ã„ã¦ä½œæ¥­ã—ã¦ã„ã¦ã‚‚äºŒæ—¥ãã‚‰ã„ãƒãƒƒãƒ†ãƒªãƒ¼ãŒæŒã£ã¦ã—ã¾ã†

- Chromeç³»ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã‚’å¤šæ•°é–‹ã„ã¦ã‚‚
- Yotuubeå‚ã‚Œæµã—ã—ã¦ã„ã¦ã‚‚

iPadæ„Ÿè¦šã§ä½¿ãˆã¦ã—ã¾ã†ï¼ˆã¡ãªã¿ã«iOSã‚¢ãƒ—ãƒªã‚‚ã‚ã‚‹ç¨‹åº¦å…¥ã‚Šã¾ã™

---

## ãŠã™ã™ã‚ç†ç”±: ãƒ•ã‚¡ãƒ³ãƒ¬ã‚¹ / ãƒ•ã‚¡ãƒ³ãŒã»ã¼å›ã‚‰ãªã„

- Macbook Airã¯ãƒ•ã‚¡ãƒ³ãƒ¬ã‚¹ã€‚ã‚ˆã»ã©ã®ã“ã¨ã‚’ã—ãªã„é™ã‚Šç†±ã‚’æŒãŸãªã„
- Mac mini , Macbook Proã¯ãƒ•ã‚¡ãƒ³æ­è¼‰ã ã‘ã©ã€ã„ã‚ã‚“ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã‚‚ãƒ•ã‚¡ãƒ³ãŒã»ã¼å›ã‚‰ãªã„ã‚‰ã—ã„

ãã®ã»ã‹ã€Macbook Airã ã¨ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚‚ã‚·ã‚¶ãƒ¼ã«æˆ»ã£ã¦~~Touchbarã‚‚ãªã„ã®ã§~~éå¸¸ã«å¿«é©

---

## ã¾ã ã“ã‚Œã‹ã‚‰éƒ¨åˆ†

- armãƒã‚¤ãƒ†ã‚£ãƒ–ã®ã‚¢ãƒ—ãƒªãŒå‡ºæƒã†ã®ã¯ã“ã‚Œã‹ã‚‰
- å¤å ´ã¯ã‚ˆãã‚ã‹ã‚‰ãªã„ï¼ˆå†¬å ´ã ã‹ã‚‰ç†±ããªã„ã®ã‹ã‚‚ï¼Ÿ

---

## æ­£ç›´æ‚ªã„è¦ç´ ãŒãªã„ã®ã§ã€æ°—ã«ãªã£ãŸã‚‰è²·ã„ã§ã™

---

# æ°—ã«ãªã£ãŸã‚‰ä»Šã™ãè²·ãŠã†ï¼ğŸ’¸

(mac miniã¯ã‚‚ã£ã¨å®‰ã„ã®ã§ã€ãã£ã¡ã‚‚ãŠã™ã™ã‚)

---

## M1 Macã‚ã¡ã‚ƒãã¡ã‚ƒå¿«t...

å†¬å ´ã¯å†·ãˆãŸã‚¢ãƒ«ãƒŸã®æ¿â€¦ğŸ¥¶

---

## Pythonä½¿ã†ãªã‚‰Rossetaãƒ¢ãƒ¼ãƒ‰

---

## Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

macOS Bug Surã«ã¯Pythonã¯æ¨™æº–ã§å…¥ã£ã¦ãªã„

- XCode or Command line tools å¿…é ˆ
  - -> Command line toolsã‚’å…¥ã‚Œã‚‹ã“ã¨ã§Python3.8ã®Universal BinaryãŒå…¥ã‚Šã¾ã™
- 3.9ã¯æœ€æ–°ç‰ˆã§Universal Binaryå¯¾å¿œï¼ˆ3.9.1ï¼‰
- ãã‚Œæ„å¤–ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³(2.7ã¯Command Line toolsã«å…¥ã£ã¦ã‚‹)ã¯x86ãƒã‚¤ãƒŠãƒªãŒä½¿ãˆã‚‹ã¯ãšï¼ˆãã‚‚ãã‚‚ä½¿ã‚ãªã„ğŸ¤”ï¼‰

---

## Universal Binaryã¨ã¯

- M1 Macã¯armã¨x86ä¸¡æ–¹ã®ãƒã‚¤ãƒŠãƒªãŒå‹•ã
  - armãƒã‚¤ãƒŠãƒªã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ã§å‹•ã
  - x86ãƒã‚¤ãƒŠãƒªã¯Rosseta2ï¼ˆã¨ã„ã†ãƒã‚¤ãƒŠãƒªãƒˆãƒ©ãƒ³ã‚¹ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰ã§å‹•ã
- armã¨x86ï¼ˆRossetaï¼‰ä¸¡æ–¹å¯¾å¿œã®ãƒã‚¤ãƒŠãƒªã‚’Univseral Binaryã¨å‘¼ã¶

ä¸¡æ–¹å‹•ãã®ã§ã€ã©ã¡ã‚‰ã§å‹•ã„ã¦ã„ã‚‹ã‹ç¢ºèªãŒå¿…è¦

---

## ãƒã‚¤ãƒŠãƒªã®å¯¾å¿œã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç¢ºèªæ–¹æ³•

fileã‚³ãƒãƒ³ãƒ‰

```
% file /usr/local/bin/python3.9
/usr/local/bin/python3.9: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64]
/usr/local/bin/python3.9 (for architecture x86_64):     Mach-O 64-bit executable x86_64
/usr/local/bin/python3.9 (for architecture arm64):      Mach-O 64-bit executable arm64
```

lipoã‚³ãƒãƒ³ãƒ‰

```
% lipo -archs /usr/local/bin/python3.9
x86_64 arm64
```
---

## ãƒã‚¤ãƒŠãƒªã®å¯¾å¿œã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç¢ºèªæ–¹æ³•
 
å‹•ã„ã¦ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãªã‚‰ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ¢ãƒ‹ã‚¿ã‚’ä½¿ã†ï¼ˆä¸€ç•ªç°¡å˜ï¼‰

![width:480px](./image/img1.png)

---

## ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã¯(zsh)ã§ã©ã†å‹•ãã‹

- Bug Suræ¨™æº–ã®zshï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚·ã‚§ãƒ«ï¼‰ã¯ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ãƒã‚¤ãƒŠãƒª
- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§èµ·å‹•ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å¾“ã†ï¼ˆã‚‰ã—ã„
  - ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ãƒã‚¤ãƒŠãƒªã®ã‚¢ãƒ—ãƒªã¯ã‚¢ãƒ—ãƒªã®å³ã‚¯ãƒªãƒƒã‚¯ã‹ã‚‰è¦‹ã‚Œã‚‹ `æƒ…å ±ã‚’è¦‹ã‚‹` ã‹ã‚‰Rossetaãƒ¢ãƒ¼ãƒ‰ã‚’èµ·å‹•ã•ã›ã‚‹ã‹è¨­å®šã§å¤‰æ›´å¯èƒ½
- ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¢ãƒ—ãƒªã§ã‚‚åˆ©ç”¨ã—ã¦ã„ã‚‹ãƒã‚¤ãƒŠãƒªã®ç¨®é¡ã§èµ·å‹•ã™ã‚‹
  - ä¾‹: x86ã®VS Codeã‹ã‚‰ã‚¿ãƒ¼ãƒŸãƒŠãƒ«èµ·å‹• -> x86ã®zshãŒèµ·å‹•

---

## ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã¯(zsh)ã§ã©ã†å‹•ãã‹

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚·ã‚§ãƒ«ãŒã©ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§å‹•ã„ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã«ã¯`unameã€€-m` or `arch`ã‚³ãƒãƒ³ãƒ‰ãŒè‰¯ã„ã€‚

```
% arch
i386
% uname -m
x86_64
```

```
# armã®zsh
(arm64) % arch
arm64
(arm64) % uname -m
arm64
```

---

## ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã¯(zsh)ã§ã©ã†å‹•ãã‹

archã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦zshã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã¨ã•ã‚‰ã«ã‚ã‹ã‚Šã‚„ã™ã„

```
## .zshrc ã«è¨˜è¼‰
export PROMPT="%n@%m(`uname -m`) %1~ %## "

## sourceã‚³ãƒãƒ³ãƒ‰ã§èª­ã¿è¾¼ã‚€
hiroshi@hrsano645noMacBook-Air slides % source ~/zshrc
hiroshi@hrsano645noMacBook-Air(x86_64) slides % 
```

---

## ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã¯(zsh)ã§ã©ã†å‹•ãã‹

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§åˆ¥ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®zshã‚’å‹•ã‹ã—ãŸã„æ™‚ã¯ã€archã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†

```
(x86_64) % arch -arm64e zsh # ã“ã“ã¾ã§x86
(arm64) %  # <- ã“ã“ã‹ã‚‰armã®zshã§å‹•ã
```

---

## ãã®Pythonã©ã£ã¡ã®ãƒã‚¤ãƒŠãƒªã§å‹•ã„ã¦ã‚‹ã®ï¼Ÿ

èµ·å‹•ã™ã‚‹ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§å¤‰ã‚ã‚‹ã®ã§ã€æ„è­˜ã—ã¦ç¢ºèªã—ã‚ˆã†ã€‚

---

## Armã®Pythonã£ã¦ä½¿ãˆã‚‹ï¼Ÿ

---

## Armã®Pythonã£ã¦ä½¿ãˆã‚‹ï¼Ÿ

- æ¨™æº–ã§ã¯è‡³ã£ã¦æ™®é€šã«å‹•ã
- venvã‚‚æ™®é€šã«å‹•ãã€‚Pure Pyhtonãªã‚‰å•é¡Œãªã„ï¼ˆã¨æ€ã‚ã‚Œã‚‹
- pipãŒå•é¡Œ

---

## pipã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã®æ§˜å­

```
hiroshi@hrsano645noMacBook-Air(x86_64) test_arm_venv % arch -arm64e zsh
hiroshi@hrsano645noMacBook-Air(arm64) test_arm_venv % python3 -m venv .env
hiroshi@hrsano645noMacBook-Air(arm64) test_arm_venv % source .env/bin/activate
(.env) hiroshi@hrsano645noMacBook-Air(arm64) test_arm_venv % pip install -U pip
Collecting pip
  Using cached pip-20.3.3-py2.py3-none-any.whl (1.5 MB)
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 20.2.3
    Uninstalling pip-20.2.3:
      Successfully uninstalled pip-20.2.3
Successfully installed pip-20.3.3
(.env) hiroshi@hrsano645noMacBook-Air(arm64) test_arm_venv % 
```
Rosseta(x86)ãƒ¢ãƒ¼ãƒ‰ã®æ¨™æº–ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰armãƒã‚¤ãƒŠãƒªã®zshã‚’èµ·å‹•ã—ã¦venvä¸Šã§è©¦ã™ã€‚

none-anyãªã‚‰å¤§ä¸ˆå¤«ãã†

---

## pipãŒmacos armã«å¯¾å¿œã—ã¦ãªã„

- pipã®ä»•æ§˜ã«macOSã®Armã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è€ƒæ…®ã—ã¦ãªã„ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚‚wheelç”Ÿæˆã‚‚ã§ããªã„ï¼ˆã¾ã ã‚‰ã—ã„ï¼Ÿ
- ä¾å­˜é–¢ä¿‚ã§ã¡ã‚‡ã£ã¨ã§ã‚‚å¼•ã£ã‹ã‹ã‚‹ã¨è‰²ã€…é¢å€’ï¼ˆæ‰‹å‹•ã§è§£æ±ºã—ãªã„ã¨ã„ã‘ãªã„ï¼‰

[Python 3.9.1ã® macOS Big Sur/Apple Siliconã‚µãƒãƒ¼ãƒˆ - python.jp](https://www.python.jp/news/2020-12-07-macos-bigsur.html)

[pip 20.3 release (Q4 2020) Â· Issue #8936 Â· pypa/pip](https://github.com/pypa/pip/issues/8936#issuecomment-735450632)

---

## macos armã®pipã§numpyã‚’å…¥ã‚Œã‚‹ã¨

```
(.env) hiroshi@hrsano645noMacBook-Air(arm64) test_arm_venv % pip install numpy  
Collecting numpy
  Using cached numpy-1.19.5.zip (7.3 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
    Preparing wheel metadata ... 
```

ã‚½ãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰èµ°ã£ã¡ã‚ƒã†ï¼ˆãã‚‚ãã‚‚wheelã®ãƒã‚¤ãƒŠãƒªãªã„ã—ï¼‰

---

## ç¾æ™‚ç‚¹ã§ã¯M1 Macã§Armãƒã‚¤ãƒ†ã‚£ãƒ–ã®Pythonã®å¸¸ç”¨ã¯é›£ã—ã„

æ„æ¬²ã‚ã‚‹æ–¹ã¯ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã®ãƒãƒ£ãƒ³ã‚¹ã§ã™ï¼M1 Macè²·ã„ã¾ï¼ˆç•¥

---

## Rossetaãƒ¢ãƒ¼ãƒ‰ã ã¨ã©ã†ãªã®ï¼Ÿ

- è‡³ã£ã¦æ™®é€šã«å‹•ãã€‚venv, pip ãªã©ãªã©
- ãŸã pipã¯æœ€æ–°ç‰ˆã«ã™ã‚‹å¿…è¦ã‚ã‚Š:
  - æ­£ã—ããƒã‚¤ãƒŠãƒªåˆ¤å®šãŒã•ã‚Œãªãã¦ã‚½ãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ãŒèµ°ã‚‹ã“ã¨
  - pipã®æœ€æ–°: pip-20.3.3
  - `pip install -U pip` ã“ã‚Œçµ¶å¯¾
- æ€§èƒ½ã¯Rossetaä¾å­˜: GPUã¨ã‹ã®æ‰±ã„ã‚ˆãã‚ã‹ã‚‰ã‚“

Webé–‹ç™ºãã‚‰ã„ãªã‚‰å•é¡Œãªãä½¿ãˆã‚‹ã¨æ€ã„ã¾ã™ã€‚

---

## Rossetaãƒ¢ãƒ¼ãƒ‰ã ã¨ã©ã†ãªã®ï¼Ÿ

```
(.env) hiroshi@hrsano645noMacBook-Air(x86_64) test_86_venv % pip install numpy
Collecting numpy
  Using cached numpy-1.19.5-cp39-cp39-macosx_10_9_x86_64.whl (15.6 MB)
Installing collected packages: numpy
Successfully installed numpy-1.19.5
```

---

## Rossetaãƒ¢ãƒ¼ãƒ‰ã ã¨ã©ã†ãªã®ï¼Ÿ

ï¼ˆã‚„ã£ã¦ã„ã¦æ°—ãŒã¤ã„ãŸã“ã¨ï¼‰

- ç¾æ™‚ç‚¹ã§pandasã‚’pipenvã§å…¥ã‚Œã‚‹ã¨pip lockãŒã¡ã‚ƒã‚“ã¨ã§ããªã„
  - ä»Šã®ã¨ã“ã‚ã€ç´ ç›´ã«venv, pipã‚’ä½¿ã£ãŸã»ã†ãŒã„ã„ã¨æ€ã†

---

## Rossetaãƒ¢ãƒ¼ãƒ‰ã§numpyãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã—ã¦ã¿ã‚‹

æä¾›: [ã‚ªãƒ¼ã‚¤ã‚·ã•ã‚“ (@oec014)](https://twitter.com/oec014)ã•ã‚“

ãƒ™ãƒ³ãƒå†…å®¹: numpyã®å†…ç©è¨ˆç®—ã®ãƒ«ãƒ¼ãƒ—ï¼ˆã‚½ãƒ¼ã‚¹ã¯ã§ããŸã‚‰å…¬é–‹ï¼‰

æ¯”è¼ƒå¯¾è±¡ã¯

- Python3.8.2 / rosseta / numpy 1.19.5
- Python3.8.2 / arm native / tfmac numpy
  - tensorflow-macosã®numpyåˆ©ç”¨
- Python3.9.0 / Ryzen7 5800X / numpy 1.19.5
  
---

## Rossetaãƒ¢ãƒ¼ãƒ‰ã§numpyãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ çµæœ

|ç’°å¢ƒ|ãƒ™ãƒ³ãƒçµæœ: ï¼•å›æ¸¬å®š/æœ€å°å€¤ (s)|
|---|---|
|Python3.8.2 / rosseta / numpy 1.19.5|38.50|
|Python3.8.2 / arm native / tfmac include numpy 1.18.5|20.62|
|Python3.9.0 / Ryzen7 5800X / numpy 1.19.5|306.63|

---

# æ‰€æ„Ÿ

- arm nativeã‚„ã°ã„ï¼ˆéœ‡ãˆ
- rossetaãŒæŒ¯ã‚‹ã‚ãªã„ã®ãŒCPUã®ãƒˆãƒ©ãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰ã®å•é¡Œãªã®ã‹ã€ãƒ¡ãƒ¢ãƒªãªã®ã‹ã¯ä¸æ˜
  - CPUã¯ãƒ™ãƒ³ãƒå›ã—ã¦ã„ã‚‹é–“ã€å„ã‚³ã‚¢ã¯90%ã¯è¶…ãˆã¦ã„ãŸãŒãšã£ã¨
  100%ã§ã¯ãªã‹ã£ãŸã€‚ãã®è¾ºãªã‚‹

armãƒã‚¤ãƒ†ã‚£ãƒ–ç’°å¢ƒã¯å¤¢ãŒã‚ã‚‹

RyzenãŒæŒ¯ã‚‹ã‚ãªã„ç†ç”±ã¯æœ€é©åŒ–ã•ã‚Œã¦ã„ãªã„ã‹ã‚‚ï¼ˆpypiã®numpyã ã‹ã‚‰ï¼Ÿï¼‰

---

# æ°—ã«ãªã£ãŸã‚‰ä»Šã™ãè²·ãŠã†ï¼ğŸ’¸

ï¼ˆã„ã‚„Mac Proå¾…ã£ãŸã»ã†ãŒã„ã„ã‹ã‚‚ã ã‘ã©ï¼‰

---

## M1æœ€é©åŒ–ã®Tensorflowã‚’è©¦ã—ã¦ã¿ãŸ

---

## tensorflow-macosãŒã‚ã‚‹

- AppleãŒå°‚ç”¨ã®ãƒ“ãƒ«ãƒ‰ã‚’ã—ãŸã‚‚ã®ã‚’å…¬é–‹
  - [apple/tensorflow_macos: TensorFlow for macOS 11.0+ accelerated using Apple's ML Compute framework.](https://github.com/apple/tensorflow_macos)
- numpyã‚‚ãƒ“ãƒ«ãƒ‰æ¸ˆã¿
  - PyPIå´ã‹ã‚‰armãƒã‚¤ãƒ†ã‚£ãƒ–ã§ãƒ“ãƒ«ãƒ‰ã—ã¦ã¿ãŸã‘ã©å‹•ã‹ãš
  - armãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ™ãƒ³ãƒã¯ã“ã¡ã‚‰ã®numpyã‚’ä½¿ã£ã¦ã¾ã™
- pandasã¯å…¥ã£ã¦ãªã„ã‚‰ã—ã„

---

å‹¢ã„ã«ä»»ã›ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ãŸã‚‚ã®ã®ã€ãƒã‚¿ãŒãªã„ã€‚

ï¼ˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãªã‚“ã‹ã‚ã‚‹ã ã‚ã†ã¨æ€ã£ãŸã‚‰ã•ã£ãã‚Šå…¥ã£ã¦ã—ã¾ã£ãŸï¼‰

---

å½“äººDLã‚„ã£ã¦ã„ãªã„ã®ã§ã‚ã‚‹ï¼ˆã‚„ã‚ŠãŸã„

ãªã‚“ã‹ãƒã‚¿ã¯ãªã„ã‚‚ã®ã‹...

---

**ãã“ã«æ•‘ä¸–ä¸»ãŒï¼ï¼ˆãƒãƒãƒ¼ãƒ³**

---

![w:480](./image/karaagesensei_ai_syoei.jpg)

---

## ã‹ã‚‰ã‚ã’å…ˆç”Ÿã®AIæœ¬ã®ã‚³ãƒ¼ãƒ‰ã‚’è©¦ã—ã¦ã¿ãŸ

<!--
- ç”»åƒè­˜åˆ¥ã®AIå‹•ã‹ã—ã¦ã¿ã‚ˆã†ï¼ˆå‹•ã‹ãªãã¦ã‚‚ãã‚ŒãŒçµæœ
- ã§ãã‚Œã°jupyterlabã§ã‚«ãƒ¼ãƒãƒ«æŒ‡å®šã—ã¦ã€x86ç’°å¢ƒã§ã‚„ã‚‹ï¼Ÿ
  - ã§ã‚‚armå´ã§jupyterå…¥ã£ã¡ã‚ƒã£ãŸã‹ã‚‰ãã‚Œã§ã‚‚ã„ã„ã‹ãªã€‚
-->

---

## ã‹ã‚‰ã‚ã’å…ˆç”Ÿæœ¬ã¨ã¯

- ã€ŒAIã€ã«é–¢ã™ã‚‹æŠ€è¡“ã‚’æ¥½ã—ãç´¹ä»‹
- ã€Œã˜ã‚ƒã‚“ã‘ã‚“ç”»åƒã‚’è‡ªå‹•èªè­˜ã™ã‚‹ã€ã€Œå®Ÿåœ¨ã—ãªã„äººã®é¡”ç”»åƒã‚’ç”Ÿæˆã™ã‚‹ã€ã€Œãƒ«ãƒ³ãƒã‚’AIã§åˆ¶å¾¡ã™ã‚‹ã€
- ç”»åƒå‡¦ç†ã€è‡ªç„¶è¨€èªã€ç”»åƒç”Ÿæˆã€å§¿å‹¢æ¨å®šã€ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã„ã£ãŸå¤šæ•°ã®æŠ€è¡“ã®ç´¹ä»‹ã¨å®Ÿè£…
- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯GitHubã«å…¬é–‹æ¸ˆã¿ã€‚Google Colabã§è©¦ã›ã‚‹

ç››ã‚Šã ãã•ã‚“ã™ãã‚‹â€¦

---

## tensorflow-macosã§å‹•ã‹ã—ã¦ã¿ã‚‹

ï¼’ç« ã®ç”»åƒåˆ†é¡(tensorflowãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰ã‚’è©¦ã—ã¾ã—ãŸã€‚

å…ƒã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯: [karaage-ai-book/02_karaage_ai_book_image_classification_tf2_x.ipynb at master Â· karaage0703/karaage-ai-book](https://github.com/karaage0703/karaage-ai-book/blob/master/ch02/02_karaage_ai_book_image_classification_tf2_x.ipynb)

---

## tensorflow-macosã§å‹•ã‹ã—ã¦ã¿ã‚‹

å…ƒã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•

- armãƒã‚¤ãƒŠãƒªã®Python3.8ã§jupyterlabã¯å‹•ã
- notebookã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€å‹•ã‹ã›ã‚‰ã‚Œã‚‹ã‚ˆã†ã«æ”¹é€ 
  - å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
  - Google CoLabå‘ã‘ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚„ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚’çœã

æ”¹é€ ã—ãŸjpnbãƒ•ã‚¡ã‚¤ãƒ« -> [tfmac_ver__02_karaage_ai_book_image_classification_tf2_x.ipynb](https://github.com/hrsano645/slides/blob/master/20210123_unagipy/tfmac_ver__02_karaage_ai_book_image_classification_tf2_x.ipynb)

---

## è©¦ã—ãŸæ§˜å­

- ã„ã¨ã‚‚ç°¡å˜ã«å‹•ã„ã¦ã—ã¾ã£ãŸâ€¦ï¼ˆãƒã‚¿ã¨ã—ã¦
- ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰æ™‚ã®æ™‚é–“ã¯Tensorflow-macosã®æ–¹ãŒæ—©ã‹ã£ãŸ
  - Google Colabã®ç„¡æ–™ç’°å¢ƒ: ç´„17.5s
  - Tensorflow-macos: ç´„9.5s

---

# æ°—ã«ãªã£ãŸã‚‰ä»Šã™ãè²·ãŠã†ï¼ğŸ’¸

M1 Macã‚’è²·ã£ãŸã‚‰ã‹ã‚‰ã‚ã’å…ˆç”Ÿã®æœ¬ã‚‚è²·ã„ã¾ã—ã‚‡ã†ï¼

---

## ã¾ã¨ã‚

- M1 Macã‚ã¡ã‚ƒãã¡ã‚ƒå¿«é©
- Pythonä½¿ã†ãªã‚‰Rossetaãƒ¢ãƒ¼ãƒ‰ãŒåŸºæœ¬çš„ã«ãŠã™ã™ã‚
- M1æœ€é©åŒ–ã®Tensorflowã‚’è©¦ã—ã¦ã¿ãŸ

---

# æ°—ã«ãªã£ãŸã‚‰ä»Šã™ãè²·ãŠã†ï¼ğŸ’¸

å†¬å ´ã¯ã‚¢ãƒ«ãƒŸã®æ¿ã§å†·ãˆã¾ã™ğŸ§Š

---

# å‚è€ƒ

- [M1 Mac](https://oku.edu.mie-u.ac.jp/~okumura/macosx/m1.html)
- [M1 Macã®é–‹ç™ºç’°å¢ƒ - Qiita](https://qiita.com/shibukawa/items/797b7cbb7e530842e6f7)
- [äººæ°—ãƒ–ãƒ­ã‚¬ãƒ¼ã‹ã‚‰ã‚ã’å…ˆç”Ÿã®ã¨ã«ã‹ãæ¥½ã—ã„AIè‡ªä½œæ•™å®¤ï½œæ—¥çµŒBPãƒ–ãƒƒã‚¯ãƒŠãƒ“ã€å…¬å¼ã‚µã‚¤ãƒˆã€‘](https://www.nikkeibp.co.jp/atclpubmkt/book/21/281460/)
  - [karaage0703/karaage-ai-book](https://github.com/karaage0703/karaage-ai-book)